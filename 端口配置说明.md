# 🔧 端口配置说明

## ✅ 端口已修改为 4000

系统端口已从 **5000** 修改为 **4000**

---

## 📝 修改的文件

### 核心文件（已修改）
1. ✅ **server/index.ts** - 后端服务器默认端口
2. ✅ **client/src/components/WebcamViewer.tsx** - WebSocket连接地址

### 文档文件（已更新）
3. ✅ **修复完成_评分系统.md** - 测试指南

---

## 🚀 如何使用

### ⚠️ 重要：正确的启动方式

**只需启动后端服务器**，它会自动集成前端：

```batch
一键启动.bat
```
或
```batch
npm run backend
```

**❌ 错误方式：** 不要同时运行 `npm run dev` 和 `npm run backend`，这会导致WebSocket连接失败！

### 访问网站

打开浏览器，访问：
```
http://localhost:4000
```

或直接访问摄像头页面：
```
http://localhost:4000/webcam
```

### 🔍 如何验证服务正常

打开浏览器控制台，应该看到：
```
🔗 WebSocket连接已建立
```

如果看到连接失败，请确保：
1. 只启动了后端服务器（不要同时运行dev和backend）
2. 访问的是 `http://localhost:4000` 而不是 `http://localhost:5173`

---

## 🔄 如何自定义端口

### 方法1: 使用环境变量（推荐）

在启动前设置环境变量：
```batch
set PORT=3000
npm run dev
```

### 方法2: 修改默认端口

编辑 `server/index.ts` 文件的第63行：
```typescript
const port = parseInt(process.env.PORT || '4000', 10);
```

将 `'4000'` 改为你想要的端口号。

**注意**: 如果修改端口，同时也需要修改 `client/src/components/WebcamViewer.tsx` 中的WebSocket连接地址（第53行）。

---

## ⚠️ 重要提醒

- 修改端口后**必须重启服务**才能生效
- 确保前端WebSocket连接地址与后端端口一致
- 如果使用环境变量，前端WebSocket可以自动适配（使用 `window.location.host`）

---

## 🔍 端口占用问题

如果4000端口被占用，可以：

1. **查看占用端口的进程**（Windows）：
   ```batch
   netstat -ano | findstr :4000
   ```

2. **结束占用的进程**：
   ```batch
   taskkill /PID <进程ID> /F
   ```

3. **或者换一个端口**（参考上面的自定义端口方法）

---

当前配置：**端口 4000** ✅

