# 性能优化 - 快速参考

## 🚀 快速开始

### 1. 启动系统
```bash
npm run dev
```

### 2. 打开 Debug 面板
- 在浏览器中按 `D` 键

### 3. 验证性能
观察 Debug 面板指标:
- ✅ Latency < 150ms (绿色)
- ✅ Inference < 80ms (绿色)  
- ✅ Render FPS ≥ 18 (绿色)
- ✅ Score Now 跟手变化

---

## 📊 Debug 面板快速解读

```
┌─────────────────────┐
│ Latency:    85 ms   │  ← 网络延迟（越低越好）
│ Inference:  42 ms   │  ← 后端推理耗时
│ WS Recv FPS: 20     │  ← WebSocket 接收帧率
│ Render FPS:  24     │  ← 前端渲染帧率
│ Score Now:   87     │  ← 当前分数（实时）
│ Landmarks OK: YES   │  ← 手势质量
└─────────────────────┘
```

**颜色含义**:
- 🟢 绿色 = 正常
- 🟡 黄色 = 可接受
- 🔴 红色 = 需要优化

---

## 🎯 核心改进

| 优化点 | 效果 |
|--------|------|
| **最新帧策略** | 消除延迟积压 |
| **rAF 渲染** | 60fps 同步绘制 |
| **No-hand 清空** | 100ms 内清除残影 |
| **镜像支持** | 骨架与手对齐 |
| **分数解耦** | Live Score 灵敏 + 进度条平滑 |

---

## ⚙️ 常用配置

### 降低延迟（若 Latency > 300ms）
```typescript
// WebcamViewer.tsx 347-348 行
const TARGET_WIDTH = 320;   // 640 → 320
const TARGET_HEIGHT = 240;  // 480 → 240
```

### 调整平滑度
```typescript
// useGestureScore.ts 54 行
const EMA_ALPHA = 0.7;  // 0.5-0.9 (越大越灵敏)
```

### 关闭视频镜像
```typescript
// WebcamViewer.tsx 113 行
const [videoMirrored, setVideoMirrored] = useState(false);
```

---

## 🐛 快速故障排查

| 问题 | 解决方案 |
|------|----------|
| 延迟高 | 降低分辨率到 320×240 |
| FPS 低 | 降低发送帧率到 15fps |
| 坐标偏移 | 切换 `videoMirrored` 开关 |
| 推理慢 | 检查 CPU 占用 / 使用前端 MediaPipe |

---

## 📈 预期性能

### 理想配置 (i5 + 8GB)
- Latency: 50-120ms
- Inference: 30-60ms
- Render FPS: 20-30

### 最低配置 (i3 + 4GB)
- Latency: 100-250ms
- Inference: 60-100ms
- Render FPS: 15-20

---

## 📚 完整文档
详见 → [性能优化说明.md](./性能优化说明.md)





